#!/usr/bin/env python3

#https://www.interviewbit.com/problems/max-sum-contiguous-subarray/
#O(n^3) solution is simple.
#You look at every pair (i,j) and compute the sum of elements between i and j and then take the maximum of the sums.
#Obviously, this is not the best solution.
#Next improvement is O(n^2) when you notice that you donâ€™t need to sum up all the elements between i and j.
# You can just add A[j] to the sum you have already calculated in the previous loop from i to j-1.
#However, we are looking for something better than N^2.
#For O(n) solution can you look at optimal subarray and deduce some observations from it?
#If you start taking every element greedily when should you stop?

#https://en.wikipedia.org/wiki/Maximum_subarray_problem

''' Editorial solution
inf = float('inf')

class Solution:
	# @param A : tuple of integers
	# @return an integer
	def maxSubArray(self, A):
	    best = -inf
	    sumsofar = 0
	    for x in A:
	        sumsofar += x
	        best = max(sumsofar, best)
	        # Doing this last, to handle case
	        # when all numbers are negative.
	        sumsofar = max(sumsofar, 0)
	    return best

'''

class Solution:
  # @param A : tuple of integers
  # @return an integer
  def maxSubArray(self, A):
    if len(A) == 1:
        return A[0]
    best_sum = float('-inf')
    best_start = best_end = 0  # or: None
    current_sum = 0
    for current_end, x in enumerate(A):
      if current_sum <= 0:
        current_start = current_end
        current_sum = x
      else:
        current_sum += x

      if current_sum > best_sum:
        best_sum = current_sum
        best_start = current_start
        best_end = current_end + 1  # the +1 is to make 'best_end' exclusive
    return best_sum

primer = Solution()
print(primer.maxSubArray([-2, 1, -3, 4, -1, 2, 1, -5, 4]))
print(primer.maxSubArray([-163,-20]))
print(primer.maxSubArray([ -178, -85, -348, -284, -129, -374, 61, -432, -205, -154, -472, -185, -128, -411, -112, -285, -467, 53, -349, -8, -263, -177, 44, -438, -45, -19, -206, -347, 73, -171, -469, -471, -151, -35, -161, -243, -401, -260, -460, -172, -31, -118, 2, -445, -332, -128, -319, -55, 36, -423, -196, -128, -374, -331, -76, 90, -352, -148, -472, -270, -37, -24, 83, -491, -12, -284, -25, -453, -266, -18, -136, -294, -222, -186, -326, -318, -363, -85, -226, -75, -13, 34, -375, -436, -485, -401, -441, 26, 31, -239, -275, -298, -329, -422, -482, -476, 87, -322, -473, -276, 38, -401, -74, -439, 92, -288, -60, -151, 42, -370, 98, -326, 83, -65, -190, -39, -386, -35, 7, -282, -250, -479, 55, 69, -383, 54, -422, -103, 43, -27, -371, -348, -457, -338, -378, -166, -344, -487, 58, -390, 97, -438, 65, -1, -6, -363, -427, -110, -464, -383, -40, -148, 19, 92, -453, 24, -287, 84, -186, -46, -2, -118, -230, -230, -219, -146, -23, -79, -403, -376, -433, -147, -186, -143, -331, -316, -144, -304, -453, -305, -125, -387, -460, -407, -490, -297, -314, -156, 6, 52, -450, -68, -237, -189, -361, -111, -383, -188, -482, -44, -432, -179, 23, -460, -220, -283, -173, -95, 91, 93, 91, -108, -111, -191, -267, -213, -15, -268, -204, -5, -436, -199, -68, -271, -332, -413, -97, -386, -98, -233, -313, -128, -393, -316, -310, -263, 32, -331, -82, -274, -55, -442, -173, -159, -185, -465, 81, -207, -274, -365, -458, -437, -265, -397, -201, -247, -58, -107, -416, -22, -431, -340, -450, -346, 65, -489, -494, -219, -13, -2, -192, -324, 44, -73, -321, -401, -488, -72, -167, -60, -446, -68, -342, 73, -231, -9, -392, -433, 48, -178, -357, -250, -148, -350, -26, -307, -173, -271, -91, -170, -490, 39, 0, -459, -9, 3, -16, -71, -473, -480, -418, -24, -258, 28, 7, -115, -104, 37, -47, -190, -301, 16, -124, -417, -4, -485, 50, -384, 25, -4, -297, 70, -339, -122, 80, -244, -228, -377, -214, -75, 48, 93, 85, -474, -18, -412, -257, -76, -111, -421, -257, -479, 27, -419, -223, 1, -205, -204, -390, -93, -486, -336, -62, -392, -272, -114, -342, -447, 27, -41, -216, -94, -367, -301, 17, -151, -115, -172, -175, -454, -355, -175, -378, -457, -8, -486, -252, 58, -492, -477, -356, -67, -406, -251, 50, -453, 12, -439, -274, 85, -383, -102, -466, 96, -277, 12, -499, 91, -352, 61, -261, 60, -227, -78, -36, -194, -130, -482, 11, -165, -475, -32, -9, -331, -329, -320, -459, -253, -487, -484, -347, -436, -485, 55, 73, -442, 93, -401, -499, -291, -486, -221, -364, -492, -193, -269, -440, -267, 55, -315, -121, 20, -111, -225, -260, 94, -366, -449, -139, -318, -464, -121, -350, -51, -480, 35, -346, -41, -84, -14, -281, -269, -185, -212, 92, -168, -35, -461, -376, -247, -436, -500, -346, -409, 29, -128, 44, -202, -477, -280, 1, -372, 12, -351, -42, 64, -178, -132, -334, -106, -132, -47, 94, -460, 62, -198, -235, -162, 75, -374, -365, -314, 57, -96, -131, 18, -18, -135, -339, -420, 55, -498, -119, 89, -130, -441, -8, -62, -443, -165, -146, 14, -405, -61, -127, -232, -291, -170, -98, -146, -267, -430, -77, -84, -428, -496, -187, -139, -158, -289, -282, -275, 59, -165, -123, -487, 11, -202, -137, -462, -94, -55, -259, 92, -368, -86, -287, -63, -182, -184, -354, -260, -49, -138, -483, -269, -197, -156, 36, -27, -301, -2, -184, -455, -39, -177, -399, -9, -305, -432, -396, -397, -430, -379, -98, -182, -458, -467, -319, -259, 81, -414, -446, 25, -30, -77, -362, -321, -218, -357, -298, -83, -229, 15, -396, -7, -298, -417, -219, -163, -478, -260, -267, -117, 68, -46, -58, 7, -241, -29, -155, 50, 51, -27, -497, -255, -379, -205, -468, -109, -319, -368, -462, -140, -347, -93, -448, -72, -324, -46, -232, -48, 59, -469, -309, 65, -485, 51, -127, -439, -147, 80, -360, -432, -387, -28, -229, 70, -235, 93, -230, -98, -205, -281, -200, -481, -294, -131, 38, -347, 51, -249, -230, 29, -500, -312, -343, -218, -38, 51, -40, -85, -104, -355, -52, -429, -235, -17, -422, -300, -372, -398, 51, -373, -205, -254, -140, -37, 37, -344, -170, 22, -476, -448, -61, -17, -92, -424, -20, -223, 57, -338, -43, 88, -292, -437, 16, -274, -281, -253, -334, -356, 51, -280, 60, -294, -34, -397, -152, -303, -478, -449, -211, -47, 40, -136, 1, -403, -65, -306, -305, 30, -212, -417, -50, -184, -357, -120, 25, -327, -356, -298, -185, -345, -458, -363, -36, -424, -162, -99, -300, -319, 86, 66, 18, 53, -171, 25, 41, -356, 28, -321, -167, -69, 97, -260, 69, -341, -422, -458, -269, -322, -132, -92, 1, -41, -380, -340, 45, -327, -272, -483, -388, -279, -24, -124, -338, -282, 13, -249, -190, -481, -446, 26, -421, -78, -308, -45, -49, 63, -64, -314, -103, -171, -193, 45, -64, -146, -394, -228, 0, -413, -368, -288, -151, -317, 27, -305, -449, -314, -171, 57, -151, -260, -120, -263, 35, -324, 83, -293, -342, -498, -309, 45, 91, -129, -359, -475, 29, -60, -448, -220, -459, -343, -349, -10, 53, -72, -483, -133, 69 ]))
